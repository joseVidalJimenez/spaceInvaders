//sound.c
// Runs on LM4F120 or TM4C123, 
// This routine calls the 4-bit DAC
// Use the Timer2 to request interrupts at a particular period.
// based on Daniel Valvano, Jonathan Valvano 

/*
Using Timer2
Configured on 32-bit mode
Configure on periodic mode, down-count
*/


#include "tm4c123gh6pm.h"
#include "sound.h"


//Global variables
unsigned int Index = 0;

//----------------------------------------------Compressed Sounds------------------------------------------
const unsigned int shoot[] = {
	0x866AD827, 0xD7369EA4, 0x5AC658D8, 0x368DA558, 0xC748D947, 0x9B738D85, 0x7DF635A7, 0x259DCCC7, 0x6105A78F, 
	0xFF700000, 0x6FFFFFC0, 0x001BA9FF, 0xFB200104, 0xAFFFFF40, 0x03438DFF, 0xF9310019, 0xDDFFFD00, 0x01128FFF, 
	0xFF900054, 0x5BFFFF93, 0x001758DF, 0xFF940000, 0x9AAEFFF5, 0x000005DE, 0xEFFF7000, 0x5438DFFF, 0xE7300078, 
	0x6CFFFE95, 0x000666BF, 0xFFFC7000, 0x3878EFFF, 0xF6300018, 0xDACFFFC1, 0x00003ADC, 0xDFFF9510, 0x00797BFF, 
	0xFFD80002, 0x558DFFFF, 0xF8000222, 0x7CFFFFFE, 0x20003348, 0xDFFFFFE2, 0x000126BF, 0xEEFFF920, 0x00016CCB, 
	0xFFFFD300, 0x00049FCC, 0xFFFF9300, 0x0027DAAE, 0xFFFD9410, 0x00687ABF, 0xFFEFE500, 0x00138DDB, 0xFFFED950, 
	0x000677BE, 0xDDFFFD73, 0x1000667A, 0xDFFEFFE9, 0x41000367, 0x9CECEFFF, 0xB9510004, 0x57ACFDDF, 0xFFD94200, 
	0x01679BDF, 0xEDFFFC72, 0x00002889, 0xBCEFEDFF, 0xE9300000, 0x4ABABBDF, 0xEDEFD831, 0x00005AAA, 0xBDECCEFF, 
	0xC9730001, 0x458ADDBA, 0xCFEDDDD7, 0x1000016A, 0xBABCEBBD, 0xDFDBA740, 0x000137AD, 0xDBABDCBC, 0xEDB95300, 
	0x00357ABD, 0xCABCCBCD, 0xEB986400, 0x00467ACC, 0xBABCBACC, 0xDDAA9620, 0x000147AD, 0xCBBCA9AB, 0xDCBBCA86, 
	0x42000257, 0x8ACDBBBB, 0xB9ABDBAB, 0xBB853210, 0x014899BB, 0xCCAAAB99, 0xACCBAAB9, 0x75410023, 0x358BBBBC, 
	0xBA9AA989, 0xBCBAAAA8, 0x76410113, 0x4579BCCB, 0xBBBA9999, 0x89ABBAA9, 0x99876332, 0x12345689, 0xBCBBBBA9, 
	0x99998899, 0xAAAB9998, 0x97765322, 0x3345679A, 0xABBBBAAA, 0xA9999888, 0x9999AAA9, 0x98987777, 0x64333344, 
	0x57779ABB, 0xBBBAAAAA, 0x99999888, 0x98888999, 0x99998888, 0x77787531, 0x00369ADF, 0xFB5437ED, 0x5447FD54, 
	0x48FD5447, 0xFD5447FD, 0x5447FD54, 0x46FE5446, 0xFE5346EF, 0x6345DF73, 0x35BF9344, 0xAFA3349F, 0xC4337FD5, 
	0x336FF633, 0x5DF8344A, 0xFB3338FD, 0x4336FF63, 0x45CF9333, 0x9FD4336F, 0xF6334CFA, 0x3348FD43, 0x36EF7334, 
	0xAFC3336F, 0xF6334BFB, 0x3337FF53, 0x35BFB334, 0x7FF6334B, 0xFB3336FF, 0x7334AFD4, 0x236DF933, 0x38FF5334, 
	0xAFC3336D, 0xF93348FF, 0x6334AFD4, 0x335CFA33, 0x46EF8334, 0x8FF62349, 0xFE4335AF, 0xD3335CFB, 0x3346DFA3, 
	0x346EF933, 0x47EF8334, 0x7EF82347, 0xFF83347E, 0xF73347EF, 0x83347EF8, 0x3347DFA3, 0x346CFB33, 0x46BFC423, 
	0x59FD4235, 0x9FF53358, 0xFF73347D, 0xFA3346BF, 0xD43359FF, 0x63357DF9, 0x3346AFD4, 0x3459FF73, 0x347CFB33, 
	0x369FF633, 0x57CFB334, 0x69FF6335, 0x7CFC4335, 0x8FF73347, 0xAFD43357, 0xDFA33469, 0xFF73346A, 0xFE43357B, 
	0xFC43368D, 0xFA33468E, 0xF833469F, 0xF633569F, 0xF53356AF, 0xE53357AF, 0xE53357AF, 0xE53357AF, 0xE633579F, 
	0xF733569E, 0xF833468D, 0xF933468C, 0xFB43457A, 0xFD433579, 0xFF733478, 0xDFA43467, 0xBFD53357, 0x9EF83346, 
	0x8BFC4346, 0x79FF8434, 0x67BFC534, 0x579EF933, 0x467AFE63, 0x4568BFC4, 0x34579DFA, 0x434679EF, 0x943467AF, 
	0xF734467A, 0xFE633467, 0xAFE63347, 0x8AFE6334, 0x78AFE733, 0x468AEF83, 0x34679DFA, 0x434679CF, 0xB434578B, 
	0xFE644478, 0xAEF94346, 0x79CFC534, 0x578AEF84, 0x44678BFC, 0x5345789D, 0xFA434678, 0xAFE74346, 0x89BFD533, 
	0x4689CFB4, 0x345789CF, 0xB4345789, 0xDFB43457, 0x89CFB434, 0x5789CFC5, 0x345789BF, 0xD6445678, 0xAEF84346, 
	0x789CFB43, 0x45789AFE, 0x64346789, 0xCFB43457, 0x88AEE843, 0x46789BFD, 0x64356789, 0xCFC53457, 0x789DFB43, 
	0x457899CF, 0xB4345779, 0x9CFC5345, 0x6789BFD6, 0x3356789A, 0xEF843467, 0x89ACFB53, 0x357789BE, 0xE8434678, 
	0x99CFD644, 0x467899CF, 0xB5344678, 0x99CFA433, 0x567899CF, 0xB4445678, 0x99CFC534, 0x567899BE, 0xD8434678, 
	0x99ACFB53, 0x4578899B, 0xEE843467, 0x8899BFD7, 0x33467899, 0x9BFC6434, 0x678999BE, 0xD7434678, 0x899ADE94, 
	0x34578899, 0x9CEC6335, 0x678999AC, 0xEA433577, 0x8999ADE9, 0x43457889, 0x99ADEA43, 0x45688999, 0xACEB6334, 
	0x6789999A, 0xDE943456, 0x789999BD, 0xC8434677, 0x89999BDD, 0x84345788, 0x9999ACDA, 0x43456789, 0x9999BDC7, 
	0x43467889, 0x9999BDC7, 0x43467899, 0x9999BDC8, 0x43457889, 0x9999ACDA, 0x63356788, 0x99999ACD, 0xA5435678, 
	0x9999999B, 0xDB743467, 0x88999999, 0xABDA5334, 0x67889999, 0x989BDA63, 0x35678899, 0x99998ACC, 0x95335678, 
	0x99999999, 0xACCA5435, 0x67899999, 0x9999ACC9, 0x53456789, 0x99999989, 0x9BCA6435, 0x67889999, 0x989889BC, 
	0xA6435678, 0x89999999, 0x888ABC95, 0x43567889, 0x99999988, 0x89ABB853, 0x45678999, 0x99899888, 0x89ABA743, 
	0x45779999, 0x99988888, 0x889BBA74, 0x44678899, 0x99998888, 0x88889ABA, 0x74345778, 0x99999988, 0x88888889, 
	0xAAB96445, 0x67889999, 0x99988888, 0x888889AB, 0xA7544568, 0x88999998, 0x88888888, 0x88889AAB, 0x96545678, 
	0x89999999, 0x88888888, 0x88888889, 0xAAA86445, 0x67889999, 0x98888888, 0x88888888, 0x888889AA, 0xA8654467, 
	0x88999999, 0x99888888, 0x88888888, 0x88888888, 0x9AAA9865, 0x44678899, 0x99999898, 0x88888888, 0x88888888, 
	0x88888888, 0x88889999, 0x98765456, 0x78899999, 0x998AB767, 0x778A8687, 0x8A76879A, 0x77878A86, 0x878A8687, 
	0x8A77878A, 0x76878A77, 0x878A7787, 0x8A878789, 0x88878998, 0x7778A878, 0x78A86878, 0xA77878A8, 0x78789987, 
	0x878A7687, 0x8A778789, 0x887788A8, 0x7878A778, 0x78988777, 0x8A87878A, 0x87878998, 0x7878A778, 0x78998777, 
	0x8A878789, 0x987878A7, 0x78789987, 0x778A7787, 0x88A87878, 0xA888788A, 0x87878998, 0x7778A878, 0x788A7787, 
	0x89A87878, 0x9887778A, 0x778788A8, 0x78789A87, 0x87899877, 0x78988778, 0x8A888778, 0xA888788A, 0x878788A7, 
	0x78788A77, 0x8788A778, 0x788A7788, 0x88A88878, 0x8A888788, 0x98887889, 0x98778889, 0x877888A8, 0x78778A77, 
	0x87889888, 0x78899877, 0x888A8788, 0x88A87878, 0x89987787, 0x8A778788, 0x98887888, 0xA8787889, 0x8887888A, 
	0x77878898, 0x887888A7, 0x78788998, 0x87888988, 0x87888A87, 0x87889988, 0x78889888, 0x78789788, 0x7888A888, 
	0x78889888, 0x88889887, 0x88899888, 0x88899888, 0x88889888, 0x88899888, 0x88899888, 0x88889877, 0x78889778, 
	0x78889788, 0x78889888, 0x78889888, 0x88888988, 0x88888988, 0x88888898, 0x88888897, 0x88888889, 0x88888889, 
	0x78888888, 0x98888888, 0x98888888, 0x89788888, 0x88988888, 0x88888888, 0x88898888, 0x88889888, 0x88888988, 
	0x88888898, 0x88788889, 0x88888888, 0x98887888, 0x88888888, 0x88888888, 0x88889888, 0x88888888, 0x88888889, 
	0x88888888, 0x98888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 
	0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 
	0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 
	0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888, 0x88888888};
//-------------------------------------------------------------------------------------------
//********functionName*****************
// Multiline description
// changes: variablesChanged
// Callers: 
// inputs: none
// outputs: none
// assumes: na
void Timer2A_Stop(void){
  TIMER2_CTL_R &= ~0x00000001; // disable
}
//********functionName*****************
// Multiline description
// changes: variablesChanged
// Callers: 
// inputs: none
// outputs: none
// assumes: na
void Timer2A_Start(void){
  TIMER2_CTL_R |= 0x00000001;   // enable
}
//********functionName*****************
// Multiline description
// changes: variablesChanged
// Callers: 
// inputs: none
// outputs: none
// assumes: na
void shipFire(void){
	unsigned int matrixSize = sizeof(shoot);
	unsigned char frameIndex;	//it counts the frame number
	for(frameIndex=0;frameIndex<=matrixSize;frameIndex++){
		unsigned char sample;
		static unsigned int frame;
		frame	= shoot[frameIndex];
		for(sample=0;sample<=7;sample++){
			volatile static unsigned char currentSample;
			currentSample	= (char)((frame&0xF0000000)>>28);
			frame <<= 4;
		}	
	};
}

